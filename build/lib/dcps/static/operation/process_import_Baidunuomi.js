function process_replace_words() {var code="#&nbsp;encoding:&nbsp;utf-8<br>'''<br>&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;a&nbsp;script&nbsp;for&nbsp;import&nbsp;document&nbsp;from&nbsp;Baidunuomi&nbsp;to&nbsp;guidetrip<br>&nbsp;&nbsp;&nbsp;&nbsp;There&nbsp;are&nbsp;some&nbsp;notes:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;add&nbsp;some&nbsp;items,&nbsp;such&nbsp;as&nbsp;productType:&nbsp;4&nbsp;and&nbsp;other&nbsp;default&nbsp;items.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;select&nbsp;user&nbsp;_id&nbsp;from&nbsp;Users&nbsp;collection&nbsp;randomly&nbsp;and&nbsp;set&nbsp;it&nbsp;to&nbsp;the&nbsp;default&nbsp;UserId&nbsp;field.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;bulk_write&nbsp;import<br>'''<br>import&nbsp;datetime<br>import&nbsp;pymongo<br>from&nbsp;util&nbsp;import&nbsp;mongo_util<br>import&nbsp;random<br><br>#&nbsp;连接sso::users<br>user_client&nbsp;=&nbsp;mongo_util.get_mongo_client(db='sso')<br>user_col&nbsp;=&nbsp;user_client.users<br>user_cursor&nbsp;=&nbsp;user_col.find()<br><br>#&nbsp;连接matafy::guidetrip<br>guidetrip_client&nbsp;=&nbsp;mongo_util.get_mongo_client()<br>guidetrip_col&nbsp;=&nbsp;guidetrip_client.guidetrip<br>guidetrip_cursor&nbsp;=&nbsp;guidetrip_col.find(({'productType':4,&nbsp;'crawled':&nbsp;True}))<br><br>#&nbsp;连接test:baidunuomi&nbsp;(已经导入到本地)<br>sicai_client&nbsp;=&nbsp;mongo_util.get_mongo_client(db='test')<br>tmp_col&nbsp;=&nbsp;sicai_client.tmp<br>sicai_col&nbsp;=&nbsp;sicai_client.baiduluomi<br>sicai_cursor&nbsp;=&nbsp;sicai_col.find()<br><br>#&nbsp;sample是随机取样<br>random1&nbsp;=&nbsp;guidetrip_col.aggregate(<br>&nbsp;&nbsp;&nbsp;&nbsp;[{'$sample':{'size':50}}]<br>)<br><br>#&nbsp;获得50个用户样本(随机),&nbsp;match为满足条件的<br>def&nbsp;get_random_user(num=50):<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;guidetrip_col.aggregate(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{'$match':{'productType':4,&nbsp;'crawled':True}},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{'$sample':{'size':num}}]<br>&nbsp;&nbsp;&nbsp;&nbsp;)<br><br>#&nbsp;for&nbsp;i&nbsp;in&nbsp;random1:<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;i.get('userId')<br><br>#&nbsp;从sicai中读取,&nbsp;并添加默认字段<br>count&nbsp;=&nbsp;0<br>samples&nbsp;=&nbsp;list(get_random_user(6500))<br><br>for&nbsp;i&nbsp;in&nbsp;sicai_cursor:<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;count&nbsp;+=&nbsp;1<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;str(len(samples))&nbsp;+&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'+&nbsp;str(count)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;获取各种参数<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;images&nbsp;+&nbsp;水印<br>&nbsp;&nbsp;&nbsp;&nbsp;images_old&nbsp;=&nbsp;i.get('imgage_ali')<br>&nbsp;&nbsp;&nbsp;&nbsp;images&nbsp;=&nbsp;[('%s%s'&nbsp;%&nbsp;(image,&nbsp;'?x-oss-process=style/watermark'))&nbsp;for&nbsp;image&nbsp;in&nbsp;images_old]<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;iconUrl&nbsp;default&nbsp;icon&nbsp;不加水印<br>&nbsp;&nbsp;&nbsp;&nbsp;iconUrl&nbsp;=&nbsp;images[0]<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;productType&nbsp;私菜是第四<br>&nbsp;&nbsp;&nbsp;&nbsp;productType&nbsp;=&nbsp;4<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gender<br>&nbsp;&nbsp;&nbsp;&nbsp;gender&nbsp;=&nbsp;'&nbsp;'<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;status<br>&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;=&nbsp;0<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;price<br>&nbsp;&nbsp;&nbsp;&nbsp;price&nbsp;=&nbsp;i.get('price')<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;feeContain&nbsp;u'暂无'<br>&nbsp;&nbsp;&nbsp;&nbsp;feeContain&nbsp;=&nbsp;u'暂无'<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;feeNotContain&nbsp;u'暂无'<br>&nbsp;&nbsp;&nbsp;&nbsp;feeNotContain&nbsp;=&nbsp;u'暂无'<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;savedraft&nbsp;1<br>&nbsp;&nbsp;&nbsp;&nbsp;savedraft&nbsp;=&nbsp;1<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;isAuth&nbsp;1<br>&nbsp;&nbsp;&nbsp;&nbsp;isAuth&nbsp;=&nbsp;1<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;role&nbsp;1<br>&nbsp;&nbsp;&nbsp;&nbsp;role&nbsp;=&nbsp;1<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;isOnline&nbsp;1<br>&nbsp;&nbsp;&nbsp;&nbsp;isOnline&nbsp;=&nbsp;1<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;updateTime&nbsp;datetime.datetime.now().strftime('%Y-%m-%d&nbsp;%H:%M:%S')<br>&nbsp;&nbsp;&nbsp;&nbsp;updateTime&nbsp;=&nbsp;datetime.datetime.now().strftime('%Y-%m-%d&nbsp;%H:%M:%S')<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;preDays&nbsp;3<br>&nbsp;&nbsp;&nbsp;&nbsp;preDays&nbsp;=&nbsp;1<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;days&nbsp;99<br>&nbsp;&nbsp;&nbsp;&nbsp;days&nbsp;=&nbsp;99<br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;description&nbsp;=&nbsp;introduce<br>&nbsp;&nbsp;&nbsp;&nbsp;description&nbsp;=&nbsp;i.get('introduce')<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;crawled&nbsp;True<br>&nbsp;&nbsp;&nbsp;&nbsp;crawled&nbsp;=&nbsp;True<br><br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;得到shop,&nbsp;如果有shop,&nbsp;则执行,&nbsp;因为有嵌套,&nbsp;所以在shop内的变量设置在下面的循环里<br>&nbsp;&nbsp;&nbsp;&nbsp;shops&nbsp;=&nbsp;i.get('shops')<br>&nbsp;&nbsp;&nbsp;&nbsp;len_shops&nbsp;=&nbsp;len(shops)<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;#&nbsp;update_bulk_write<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;requests&nbsp;=&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;count<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;count&nbsp;!=&nbsp;0:<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_col.bulk_write(requests)<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;tmp_col.insert_many(&nbsp;[{&nbsp;'insertOne'&nbsp;:&nbsp;{&nbsp;'document'&nbsp;:&nbsp;'aaa'&nbsp;}&nbsp;}]&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;count&nbsp;>=&nbsp;1000:<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;guidetrip_col.bulk_write(requests)<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_col.bulk_write(requests)<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;count<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;'hhhh'<br>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br><br>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;len_shops&nbsp;!=&nbsp;0:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;shops[len_shops&nbsp;-&nbsp;1]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len_shops&nbsp;-=&nbsp;1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;shop&nbsp;当前的店铺<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shop&nbsp;=&nbsp;shops[len_shops&nbsp;-&nbsp;1]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;title:&nbsp;shops里的店名<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;title&nbsp;=&nbsp;shop['name']<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;tripPlan&nbsp;[dict(imageUrl=image_urls,&nbsp;pointDesc=description,&nbsp;pointName=title]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tripPlan&nbsp;=&nbsp;[dict(imageUrl=images,&nbsp;pointDesc=description,&nbsp;pointName=title)]<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;userId&nbsp;sample.get('userId')<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;samples没了,&nbsp;继续生成<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(samples)&nbsp;==&nbsp;0:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;在内存允许的情况下,&nbsp;越多越快,&nbsp;这里设置6000<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;samples&nbsp;=&nbsp;list(get_random_user(6000))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;获取新sample<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sample&nbsp;=&nbsp;samples.pop()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;userId&nbsp;=&nbsp;sample.get('userId')<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;'userId:&nbsp;'&nbsp;+&nbsp;&nbsp;sample.get('userId')<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;#&nbsp;name&nbsp;私菜发布者姓名<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;=&nbsp;sample.get('name')<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;name<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;city&nbsp;city.strip()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;meetPlace&nbsp;city.strip()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;location&nbsp;'&nbsp;'<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;meetPlace&nbsp;=&nbsp;city&nbsp;=&nbsp;shop['address'][:3]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;location&nbsp;=&nbsp;shop['address']<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;city<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;meetPlace&nbsp;=&nbsp;city&nbsp;=''<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;location&nbsp;=&nbsp;''<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;lat<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lat&nbsp;=&nbsp;shop['baidu_latitude']<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;lon<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lon&nbsp;=&nbsp;shop['baidu_longitude']<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;age<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;age&nbsp;=&nbsp;0<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;建立新的文档<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;type(i)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['userId']&nbsp;=&nbsp;userId<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['iconUrl']&nbsp;=&nbsp;iconUrl<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['name']&nbsp;=&nbsp;name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['city']&nbsp;=&nbsp;city<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['productType']&nbsp;=&nbsp;productType<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['gender']&nbsp;=&nbsp;gender<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['title']&nbsp;=&nbsp;title<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['lat']&nbsp;=&nbsp;lat<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['lon']&nbsp;=&nbsp;lon<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['description']&nbsp;=&nbsp;description<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['images']&nbsp;=&nbsp;images<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['status']&nbsp;=&nbsp;status<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['price']&nbsp;=&nbsp;price<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['age']&nbsp;=&nbsp;age<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['feeContain']&nbsp;=&nbsp;feeContain<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['feeNotContain']&nbsp;=&nbsp;feeNotContain<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['savedraft']&nbsp;=&nbsp;savedraft<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['meetPlace']&nbsp;=&nbsp;meetPlace<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['location']&nbsp;=&nbsp;location<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['isAuth']&nbsp;=&nbsp;isAuth<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['role']&nbsp;=&nbsp;role<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['isOnline']&nbsp;=&nbsp;isOnline<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['updateTime']&nbsp;=&nbsp;updateTime<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['preDays']&nbsp;=&nbsp;preDays<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['days']&nbsp;=&nbsp;days<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['tripPlan']&nbsp;=&nbsp;tripPlan<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i['crawled']&nbsp;=&nbsp;crawled<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;i<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;del&nbsp;i['_id']<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_col.insert_one(i)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;'asdfffffffffffffffff'<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;+=&nbsp;1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;count<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print(new_guide.__dict__)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gid&nbsp;=&nbsp;guides_db[guides_col].insert_one(new_guide.__dict__).inserted_id<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print(str(gid)&nbsp;+&nbsp;'<><>gid<><>')<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;'''<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;processed&nbsp;flag<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;'''<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;source_db[baixing_col].update({'_id':&nbsp;guide.get('_id')},&nbsp;{'$set':&nbsp;{'processed':&nbsp;True}},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;upsert=False)<br><br><br>";return code;}